@model MyProject.Models.UsuarioModel

@{
    ViewData["Title"] = "Cadastro de Usuário";
    var plano = ViewBag.Plano;
}

<link rel="stylesheet" href="~/css/plans_and_auth.css" asp-append-version="true" />

<div class="cadastro-container">
    <!-- Header -->
    <div class="cadastro-header">
        <h1>Cadastro de Usuário</h1>
        <p>Crie sua conta para acessar o sistema HelpDesk</p>
        @if (!string.IsNullOrEmpty(plano))
        {
            <div class="plan-badge">
                @if (plano == "plano1")
                {
                    <text>Plano Web Básico - R$ 199,00/mês</text>
                }
                else if (plano == "plano2")
                {
                    <text>Plano Web + Desktop - R$ 599,00/mês</text>
                }
                else if (plano == "plano3")
                {
                    <text>Plano Completo - R$ 999,00/mês</text>
                }
            </div>
        }
    </div>

    <!-- Info Box -->
    @if (!string.IsNullOrEmpty(plano))
    {
        <div class="info-box">
            <strong>ℹ️ Importante:</strong> Este é o usuário administrador da sua conta. Após criar sua conta, você poderá adicionar mais usuários da sua empresa.
        </div>
    }

    <!-- Form -->
    <form asp-action="Criar" method="post">
        <input type="hidden" name="plano" value="@plano" />

        <!-- Nome -->
        <div class="form-group">
            <label asp-for="Nome" class="form-label">Nome Completo *</label>
            <input asp-for="Nome" class="form-control" placeholder="Digite seu nome completo" required>
            <span asp-validation-for="Nome" class="text-danger"></span>
        </div>

        <!-- Email -->
        <div class="form-group">
            <label asp-for="Email" class="form-label">E-mail *</label>
            <input asp-for="Email" type="email" class="form-control" placeholder="seu.email@empresa.com" required>
            <span asp-validation-for="Email" class="text-danger"></span>
        </div>

        <!-- Contato -->
        <div class="form-group">
            <label asp-for="Contato" class="form-label">Telefone de Contato *</label>
            <input asp-for="Contato" class="form-control" placeholder="(11) 99999-9999" required>
            <span asp-validation-for="Contato" class="text-danger"></span>
        </div>

        <!-- Senha -->
        <div class="form-group">
            <label asp-for="Senha" class="form-label">Senha *</label>
            <input asp-for="Senha" type="password" class="form-control" placeholder="Digite uma senha segura" required>
            <div class="form-text">
                Sua senha deve ter de 8 a 20 caracteres, conter letras maiúsculas, minúsculas e números.
            </div>
            <span asp-validation-for="Senha" class="text-danger"></span>
        </div>

        <!-- Confirmar Senha -->
        <div class="form-group">
            <label for="confirma_senha" class="form-label">Confirmar Senha *</label>
            <input type="password" id="confirma_senha" class="form-control" placeholder="Confirme sua senha" required>
            <div id="senhaErro" class="text-danger" style="display: none;">
                As senhas não coincidem.
            </div>
        </div>

        <!-- Buttons -->
        <div class="form-buttons">
            <button type="submit" class="btn btn-primary">
                Criar Conta
            </button>
            <a href="@Url.Action("Index", "Home")" class="btn btn-secondary text-decoration-none d-flex align-items-center justify-content-center">
                Cancelar
            </a>
        </div>
    </form>
</div>

<script>
    // Função para validar se as senhas coincidem
    function validarSenhas() {
        const senha = document.querySelector('input[name="Senha"]').value;
        const confirmaSenha = document.getElementById('confirma_senha').value;
        const erroDiv = document.getElementById('senhaErro');

        if (confirmaSenha === '') {
            erroDiv.style.display = 'none';
            return true;
        }

        if (senha !== confirmaSenha) {
            erroDiv.style.display = 'block';
            return false;
        } else {
            erroDiv.style.display = 'none';
            return true;
        }
    }

    // Validar ao submeter o formulário
    document.querySelector('form').addEventListener('submit', function (e) {
        if (!validarSenhas()) {
            e.preventDefault();
        }
    });

    // Adiciona eventos para validar em tempo real
    document.getElementById('confirma_senha').addEventListener('input', validarSenhas);
    document.querySelector('input[name="Senha"]').addEventListener('input', validarSenhas);
</script>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}

